<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>Step 3: Create the .h File</title>
<script language="JavaScript">
<!-- hide
function openWin(term) {
  url="../../information/glossary.html#" + term;
  myWin= window.open(url, "Glossary",
              "width=400,height=150,scrollbars=yes,status=no,toolbar=no,menubar=no");
  myWin.focus();
}
//-->
</script>
</head>
<body BGCOLOR="#ffffff" LINK="#000099">
<B><FONT SIZE="-1">The Java</font><sup><font size="-2">TM</font></sup> <font size="-1">Tutorial</FONT></B>
<br>
<table width="550">
<tr>
<td align="left" valign="center">
<a href="step2.html" target="_top"><img src="../../images/PreviousArrow.gif" width="26" height="26" align="center" border="0" alt="Previous Page"></a>
<a href="../TOC.html#stepbystep" target="_top"><img src="../../images/TOCIcon.gif" width="26" height="26" align="center" border="0" alt="Lesson Contents"></a>
<a href="step4.html" target="_top"><img src="../../images/NextArrow.gif" width="26" height="26" align="center" border="0" alt="Next Page"></a></td>

<td align="center" valign="center">
<font size="-1">
<a href="../../index.html" target="_top">Start of Tutorial</a>
&gt;
<a href="../index.html" target="_top">Start of Trail</a>
&gt;
<a href="index.html" target="_top">Start of Lesson</a>
</font>
</td>

<td align="right" valign="center">
<font size="-1">
<a href="../../search.html" target="_top">Search</a>
<br><a href="../../forms/sendusmail.html">Feedback Form</a>
</font>
</td>

</tr>
</table>
<img src="../../images/blueline.gif" width="550" height="8" ALIGN="BOTTOM" NATURALSIZEFLAG="3">
<br>

<font size="-1">
<b>Trail</b>: Java Native Interface
<br>
<b>Lesson</b>: Writing a Java Program with Native Methods
</font>

<h2>
Step 3: Create the .h File
</h2>
<blockquote>
In this step, you use the <code>javah</code> utility program to
generate a header file (a <code>.h</code> file) from the
<code>HelloWorld</code> class. The header file provides a C
function signature for the implementation of the native method
<code>displayHelloWorld</code> defined in that class.

<p> <a href=_runjavah.html>Run <code>javah</code></a> now on the
<code>HelloWorld</code> class that you created in the previous steps.
<p>
The name of the header file is the Java class name with a
<code>.h</code> appended to the end. For example, the command
shown above will generate a file named <a
href="example-1dot1/HelloWorld.h"><code>HelloWorld.h</code></a>.

<p> By default, <code>javah</code> places the new <code>.h</code> file
in the same directory as the <code>.class</code> file. 
 Use the <code>-d</code> option to instruct 
<code>javah</code> to place the header files in a different directory.


</blockquote>
<h3>The Function Definition</h3>
Look at the header file <code>HelloWorld.h</code>.
<blockquote><pre>
/* DO NOT EDIT THIS FILE - it is machine generated */
#include &lt;jni.h&gt;
/* Header for class HelloWorld */

#ifndef _Included_HelloWorld
#define _Included_HelloWorld
#ifdef __cplusplus
extern &quot;C&quot; {
#endif
/*
 * Class:     HelloWorld
 * Method:    displayHelloWorld
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_HelloWorld_displayHelloWorld
  (JNIEnv *, jobject);

#ifdef __cplusplus
}
#endif
#endif
</pre></blockquote>

The <code>Java_HelloWorld_displayHelloWorld</code> function provides the
implementation for the <code>HelloWorld</code> class's native method
<code>displayHelloWorld</code>, which you will write in <a
href="step4.html">Step 4: Write the Native Method Implementation</a>.
You use the same function signature when you write the implementation
for the native method.

<p> If <code>HelloWorld</code> contained any other native methods,
their function signatures would appear here as well.

<p> The name of the native language function that implements the
native method consists of the prefix <code>Java_</code>, the package
name, the class name, and the name of the native method. Between
each name component is an underscore "_" separator.  Graphically, this looks as follows:


<p><center><a href="../../figures/native1.1/nativehello.gif" target="_top"><IMG SRC="../../figures/native1.1/nativehello.gif" WIDTH="460" HEIGHT="169" ALIGN="BOTTOM" NATURALSIZEFLAG="3" ALT=""></a><br><em>This figure has been reduced to fit on the page. <br> Click the image to view it at its natural size.</em></center></p>

<p>
The native method <code>displayHelloWorld</code> within the
<code>HelloWorld</code> class becomes
<code>Java_HelloWorld_displayHelloWorld</code>.  No package name appears in our example because <code>HelloWorld</code> is in the
default package, which has no name.

<p> Notice that the implementation of the native 
function, as it appears in the header file, accepts two parameters even though, in its definition on the
Java side, it accepts no parameters. The JNI requires every native method to have these two parameters. 

<p>
The first parameter for every
native method is a <code>JNIEnv</code> interface pointer. It is
through this pointer that your native code accesses parameters and
objects passed to it from the Java application.  The second parameter is 
<code>jobject</code>, which references the current object
itself.  In a sense, you can
think of the <code>jobject</code> parameter as the "this" variable in
 Java.  For a native instance method, such as the
<code>displayHelloWorld</code> method in our example, the <code>jobject</code> argument is
a reference to the current instance of the object.  For native class methods, this argument
would be a reference to the method's Java class.   Our example ignores both parameters. The next lesson,

<a target="_top" href="../integrating/index.html ">Getting Started</a><a target="_top" href="../integrating/index.html "><img src="../../images/tutorialIcon.gif" width=11 height=11 border=0 align="ABSMIDDLE" alt="(in the Java Native Interface trail)"></a>
, describes how to access data using the JNI interface pointer
<code>env</code> parameter.  The next lesson also provides more information about <code>jobject</code>.  

</blockquote>

<img src="../../images/blueline.gif" width="550" height="8" ALIGN="BOTTOM" NATURALSIZEFLAG="3">
<br>
<table width="550">
<tr>
<td align="left" valign="center">
<a href="step2.html" target="_top"><img src="../../images/PreviousArrow.gif" width="26" height="26" align="center" border="0" alt="Previous Page"></a>
<a href="../TOC.html#stepbystep" target="_top"><img src="../../images/TOCIcon.gif" width="26" height="26" align="center" border="0" alt="Lesson Contents"></a>
<a href="step4.html" target="_top"><img src="../../images/NextArrow.gif" width="26" height="26" align="center" border="0" alt="Next Page"></a></td>

<td align="center" valign="center">
<font size="-1">
<a href="../../index.html" target="_top">Start of Tutorial</a>
&gt;
<a href="../index.html" target="_top">Start of Trail</a>
&gt;
<a href="index.html" target="_top">Start of Lesson</a>
</font>
</td>

<td align="right" valign="center">
<font size="-1">
<a href="../../search.html" target="_top">Search</a>
<br><a href="../../forms/sendusmail.html">Feedback Form</a>
</font>
</td>

</tr>
</table>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>Writing a Java Program with Native Methods</title>
<script language="JavaScript">
<!-- hide
function openWin(term) {
  url="../../information/glossary.html#" + term;
  myWin= window.open(url, "Glossary",
              "width=400,height=150,scrollbars=yes,status=no,toolbar=no,menubar=no");
  myWin.focus();
}
//-->
</script>
</head>
<body BGCOLOR="#ffffff" LINK="#000099">
<B><FONT SIZE="-1">The Java</font><sup><font size="-2">TM</font></sup> <font size="-1">Tutorial</FONT></B>
<br>
<table width="550">
<tr>
<td align="left" valign="center">
<a href="../concepts/index.html" target="_top"><img src="../../images/PreviousArrow.gif" width="26" height="26" align="center" border="0" alt="Previous Page"></a>
<a href="../TOC.html#stepbystep" target="_top"><img src="../../images/TOCIcon.gif" width="26" height="26" align="center" border="0" alt="Lesson Contents"></a>
<a href="step1.html" target="_top"><img src="../../images/NextArrow.gif" width="26" height="26" align="center" border="0" alt="Next Page"></a></td>

<td align="center" valign="center">
<font size="-1">
<a href="../../index.html" target="_top">Start of Tutorial</a>
&gt;
<a href="../index.html" target="_top">Start of Trail</a>
</font>
</td>

<td align="right" valign="center">
<font size="-1">
<a href="../../search.html" target="_top">Search</a>
<br><a href="../../forms/sendusmail.html">Feedback Form</a>
</font>
</td>

</tr>
</table>
<img src="../../images/blueline.gif" width="550" height="8" ALIGN="BOTTOM" NATURALSIZEFLAG="3">

<br>
<font size="-1">
<b>Trail</b>: Java Native Interface
</font>

<h2>
Lesson: Writing a Java Program with Native Methods
</h2>
<blockquote>
This lesson walks you through the steps necessary to integrate native
code with programs written in Java.
<p>
This lesson implements the canonical "Hello World!"
program.  The "Hello World!" program has one Java class, called <code>HelloWorld</code>.  <code>HelloWorld.java</code> does two things: it declares a native method that displays "Hello World!" and it implements the <code>main</code> method for
the overall program.  The implementation
for the native method is provided in C.

<p>

<blockquote><hr><strong>Note :</strong>&nbsp;
This lesson assumes that you are starting with neither existing C functions nor Java classes. While "in the real world" you probably have existing C functions that you wish to integrate with Java programs, you will still need to modify the signatures for these C functions to work with the JNI.  To be sure that you use the correct signatures, it is best to begin by writing and compiling the Java code, as described here.
<hr></blockquote>    

</blockquote>
<h3>Background</h3>
<p>
Writing native methods for Java programs is a multi-step process.
<ol><li>
Begin by writing the Java program. Create a Java class that 
declares the native method; this class contains the declaration or signature for the native 
method.  It also includes a <code>main</code> method which calls the native method.</li>
<li>Compile the Java class that declares the native method and the <code>main</code> method. </li>
<li>Generate a header file for the native method using <code>javah</code>  
with the native interface flag <code>-jni</code>.  Once you've generated the header file you have the formal signature for 
your native method.</li>
<li>Write the implementation of the native method in 
the programming language of your choice, such as C or C++. </li>
<li>Compile 
the header and implementation files into a shared library file.</li>
<li>Run the Java 
program.</li></ol>
<p>
 The following figure illustrates these steps for the Hello World program:

<p><center><IMG SRC="../../figures/native1.1/native3.gif" WIDTH="438" HEIGHT="651" ALIGN="BOTTOM" NATURALSIZEFLAG="3" ALT=""></center></p>

<p>
<h3>
<a href=step1.html>Step 1: Write the Java Code</a>
</h3>
<blockquote>
Create a Java class named <code>HelloWorld</code> that declares a native 
method.  This class also includes a <code>main</code> method that creates a <code>HelloWorld</code> object
and calls the native method.
</blockquote>

<h3>
<a href=step2.html>Step 2: Compile the Java Code</a>
</h3>
<blockquote>
Use <code>javac</code> to compile the Java code that you wrote in <strong>Step 1</strong>.
</blockquote>

<h3>
<a href=step3.html>Step 3: Create the .h File</a>
</h3>
<blockquote>
Use <code>javah</code> to create a JNI-style header file (a <code>.h</code> file) from
the <code>HelloWorld</code> class. The header file provides a function signature for the implementation of the native method
<code>displayHelloWorld</code>.
</blockquote>

<h3>
<a href=step4.html>Step 4: Write the Native Method Implementation</a>
</h3>
<blockquote>
Write the implementation for the native method in a native language (such as ANSI C) 
source file. The implementation
will be a regular function that's integrated with your Java class. 
</blockquote>

<h3>
<a href=step5.html>Step 5: Create a Shared Library</a>
</h3>
<blockquote>
Use the C compiler to compile the <code>.h</code> file and the <code>.c</code>
file that you created in <strong>Steps 3 and 4</strong> into a shared library.
In Windows 95/NT terminology, a shared library is called a dynamically loadable library (DLL).
</blockquote>

<h3>
<a href=step6.html>Step 6: Run the Program</a>
</h3>
<blockquote>
And finally, use <code>java</code>, the Java interpreter, to run the program.


</blockquote>

<img src="../../images/blueline.gif" width="550" height="8" ALIGN="BOTTOM" NATURALSIZEFLAG="3">
<br>
<table width="550">
<tr>
<td align="left" valign="center">
<a href="../concepts/index.html" target="_top"><img src="../../images/PreviousArrow.gif" width="26" height="26" align="center" border="0" alt="Previous Page"></a>
<a href="../TOC.html#stepbystep" target="_top"><img src="../../images/TOCIcon.gif" width="26" height="26" align="center" border="0" alt="Lesson Contents"></a>
<a href="step1.html" target="_top"><img src="../../images/NextArrow.gif" width="26" height="26" align="center" border="0" alt="Next Page"></a></td>

<td align="center" valign="center">
<font size="-1">
<a href="../../index.html" target="_top">Start of Tutorial</a>
&gt;
<a href="../index.html" target="_top">Start of Trail</a>
</font>
</td>

<td align="right" valign="center">
<font size="-1">
<a href="../../search.html" target="_top">Search</a>
<br><a href="../../forms/sendusmail.html">Feedback Form</a>
</font>
</td>

</tr>
</table>
</body>
</html>

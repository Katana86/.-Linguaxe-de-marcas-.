
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>Verify the Signature</title>
<script language="JavaScript">
<!-- hide
function openWin(term) {
  url="../../information/glossary.html#" + term;
  myWin= window.open(url, "Glossary",
              "width=400,height=150,scrollbars=yes,status=no,toolbar=no,menubar=no");
  myWin.focus();
}
//-->
</script>
</head>
<body BGCOLOR="#ffffff" LINK="#000099">
<B><FONT SIZE="-1">The Java</font><sup><font size="-2">TM</font></sup> <font size="-1">Tutorial</FONT></B>
<br>
<table width="550">
<tr>
<td align="left" valign="center">
<a href="vstep3.html" target="_top"><img src="../../images/PreviousArrow.gif" width="26" height="26" align="center" border="0" alt="Previous Page"></a>
<a href="../TOC.html#apisign" target="_top"><img src="../../images/TOCIcon.gif" width="26" height="26" align="center" border="0" alt="Lesson Contents"></a>
<a href="vstep5.html" target="_top"><img src="../../images/NextArrow.gif" width="26" height="26" align="center" border="0" alt="Next Page"></a></td>

<td align="center" valign="center">
<font size="-1">
<a href="../../index.html" target="_top">Start of Tutorial</a>
&gt;
<a href="../index.html" target="_top">Start of Trail</a>
&gt;
<a href="index.html" target="_top">Start of Lesson</a>
</font>
</td>

<td align="right" valign="center">
<font size="-1">
<a href="../../search.html" target="_top">Search</a>
<br><a href="../../forms/sendusmail.html">Feedback Form</a>
</font>
</td>

</tr>
</table>
<img src="../../images/blueline.gif" width="550" height="8" ALIGN="BOTTOM" NATURALSIZEFLAG="3">
<br>

<font size="-1">
<b>Trail</b>: Security in Java 2 SDK 1.2
<br>
<b>Lesson</b>: Generating and Verifying Signatures
</font>

<h2>
Verify the Signature
</h2>
<blockquote>
<p>You've added code to the <code>VerSig</code> program to

<ul>

<li>Input the encoded key bytes and converted them
to a <code>PublicKey</code> named <code>pubKey</code><p>
<li>Input the signature bytes into a byte array named <code>sigToVerify</code>

</ul>

You can now proceed to do the verification.


<p><b>Initialize the Signature Object for Verification</b>

<blockquote>

<p>As with signature generation, a signature is verified by
using an instance of the <code>Signature</code> class. 
You need to create a <code>Signature</code> object that uses the same signature algorithm
as was used to generate the signature. The algorithm used by the
<code>GenSig</code> program was the SHA1withDSA algorithm from the SUN
provider.

<blockquote><pre>
Signature sig = Signature.getInstance("SHA1withDSA", "SUN");
</pre></blockquote>

Next, you need to initialize the <code>Signature</code> object.
The initialization method for verification requires the public key.

<blockquote><pre>
sig.initVerify(pubKey);
</pre></blockquote>

</blockquote>


<p><b>Supply the Signature Object With the Data to be Verified</b>

<blockquote>

You now need to supply the <code>Signature</code> object with the data for which
a signature was generated. This data is in the file whose name was
specified as the third command line argument. As you did
when signing, read in the data one buffer at a time, and supply it to
the <code>Signature</code> object by calling the <code>update</code> method.

<blockquote><pre>
FileInputStream datafis = new FileInputStream(args[2]);
BufferedInputStream bufin = new BufferedInputStream(datafis);

byte[] buffer = new byte[1024];
int len;
while (bufin.available() != 0) {
    len = bufin.read(buffer);
    sig.update(buffer, 0, len);
};

bufin.close();
</pre></blockquote>

</blockquote>

<p><b>Verify the Signature</b>

<blockquote>

<p>Once you have supplied all of the data to the <code>Signature</code> object,
you can verify the digital signature of that data and report
the result. Recall that
the alleged signature was read into a byte array called <code>sigToVerify</code>.

<blockquote><pre>
boolean verifies = sig.verify(sigToVerify);

System.out.println("signature verifies: " + verifies);
</pre></blockquote>

<p>The <code>verifies</code> value will be <code>true</code> if
the alleged signature (<code>sigToVerify</code>) is the actual signature of the
specified data file generated by the private key corresponding to the
public key <code>pubKey</code>.

</blockquote>



</blockquote>

<img src="../../images/blueline.gif" width="550" height="8" ALIGN="BOTTOM" NATURALSIZEFLAG="3">
<br>
<table width="550">
<tr>
<td align="left" valign="center">
<a href="vstep3.html" target="_top"><img src="../../images/PreviousArrow.gif" width="26" height="26" align="center" border="0" alt="Previous Page"></a>
<a href="../TOC.html#apisign" target="_top"><img src="../../images/TOCIcon.gif" width="26" height="26" align="center" border="0" alt="Lesson Contents"></a>
<a href="vstep5.html" target="_top"><img src="../../images/NextArrow.gif" width="26" height="26" align="center" border="0" alt="Next Page"></a></td>

<td align="center" valign="center">
<font size="-1">
<a href="../../index.html" target="_top">Start of Tutorial</a>
&gt;
<a href="../index.html" target="_top">Start of Trail</a>
&gt;
<a href="index.html" target="_top">Start of Lesson</a>
</font>
</td>

<td align="right" valign="center">
<font size="-1">
<a href="../../search.html" target="_top">Search</a>
<br><a href="../../forms/sendusmail.html">Feedback Form</a>
</font>
</td>

</tr>
</table>
</body>
</html>
